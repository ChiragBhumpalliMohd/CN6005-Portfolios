# === California Housing Price Prediction using Linear Regression ===

# Import libraries
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

# Scikit-learn modules
from sklearn.datasets import fetch_california_housing
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error, mean_absolute_error, r2_score
from sklearn.preprocessing import StandardScaler
from sklearn.pipeline import Pipeline

# --- Step 1: Load and explore data ---
california = fetch_california_housing()
data = pd.DataFrame(california.data, columns=california.feature_names)
data['MedHouseVal'] = california.target

print("=== First 5 Rows ===")
print(data.head())
print("\n=== Missing Values ===")
print(data.isnull().sum())
print("\n=== Statistical Summary ===")
print(data.describe())

# --- Step 2: Visualization ---
# Pairplot (subset of features)
sns.pairplot(data[['MedInc', 'HouseAge', 'AveRooms', 'Population', 'MedHouseVal']])
plt.show()

# Correlation matrix
plt.figure(figsize=(10, 8))
sns.heatmap(data.corr(), annot=True, cmap='coolwarm')
plt.title('Correlation Matrix')
plt.show()

# --- Step 3: Feature Selection ---
corr_matrix = data.corr()
corr_target = abs(corr_matrix['MedHouseVal'])

# Select features with |correlation| >= 0.5
high_corr_features = corr_target[corr_target >= 0.5].index.tolist()
high_corr_features.remove('MedHouseVal')

print("\n=== Features with |correlation| >= 0.5 ===")
print(high_corr_features)

# Define features and target
X = data[high_corr_features]
y = data['MedHouseVal']

# --- Step 4: Split data ---
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)
print(f"\nTraining set size: {X_train.shape}")
print(f"Testing set size: {X_test.shape}")

# --- Step 5: Build and train model ---
pipeline = Pipeline([
    ('scaler', StandardScaler()),
    ('lr', LinearRegression())
])

pipeline.fit(X_train, y_train)

# --- Step 6: Model Evaluation ---
y_pred = pipeline.predict(X_test)

mse = mean_squared_error(y_test, y_pred)
rmse = np.sqrt(mse)
mae = mean_absolute_error(y_test, y_pred)
r2 = r2_score(y_test, y_pred)

print("\n=== Model Evaluation ===")
print(f"Mean Squared Error (MSE): {mse:.4f}")
print(f"Root Mean Squared Error (RMSE): {rmse:.4f}")
print(f"Mean Absolute Error (MAE): {mae:.4f}")
print(f"R-squared (RÂ²): {r2:.4f}")

# --- Step 7: Predictions on Dummy Data ---
dummy_data = pd.DataFrame({
    'MedInc': [5.0, 8.0, 3.0],
    'AveRooms': [6.0, 5.0, 4.0],
    'AveOccup': [3.0, 2.5, 4.0],
    'Latitude': [34.0, 36.0, 38.0]
})

dummy_predictions = pipeline.predict(dummy_data)
print("\n=== Predictions on Dummy Data ===")
for i, pred in enumerate(dummy_predictions, start=1):
    print(f"Dummy Data {i}: Predicted MedHouseVal = {pred:.4f}")




























